<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime Direct Player</title>
    <style>
        body {
            background-color: #0f0f0f;
            color: #f5f5f5;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        h1 {
            color: #b300ff;
            text-align: center;
            margin-bottom: 30px;
        }

        .player-container {
            background-color: #1a1a1a;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        video {
            width: 100%;
            display: block;
            background: #000;
        }

        .controls {
            background-color: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #b300ff;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            background-color: #2a2a2a;
            border: 1px solid #444;
            border-radius: 4px;
            color: #fff;
        }

        button {
            background-color: #b300ff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            display: inline-block;
            margin-right: 10px;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #9700d6;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .alert {
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .alert-error {
            background-color: rgba(255, 0, 0, 0.2);
            border-left: 4px solid #ff5555;
        }

        .alert-success {
            background-color: rgba(0, 255, 0, 0.2);
            border-left: 4px solid #55ff55;
        }

        .url-display {
            background-color: #2a2a2a;
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
            word-break: break-all;
            font-family: monospace;
        }

        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
        }

        .examples {
            margin-top: 30px;
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
        }

        .examples h3 {
            margin-top: 0;
            color: #b300ff;
        }

        .examples ul {
            list-style-type: none;
            padding: 0;
        }

        .examples li {
            margin-bottom: 10px;
        }

        .examples a {
            color: #55aaff;
            text-decoration: none;
            cursor: pointer;
        }

        .examples a:hover {
            text-decoration: underline;
        }

        /* Direct sources URLs */
        .direct-sources {
            margin-top: 20px;
            border-top: 1px solid #444;
            padding-top: 15px;
        }

        .source-item {
            background-color: #2a2a2a;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .source-item button {
            padding: 6px 12px;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Anime Direct Player</h1>

        <div class="alert alert-error">
            <p>The Anime Rouge API is currently unavailable (404 DEPLOYMENT_NOT_FOUND). This is a direct player solution using hardcoded sources.</p>
        </div>

        <div class="player-container">
            <video id="videoPlayer" controls></video>
        </div>

        <div class="controls">
            <h2>Play Anime from Direct Sources</h2>

            <div class="direct-sources">
                <h3>Available Sources:</h3>

                <div class="source-item">
                    <span>Tokyo Ghoul Episode 1 (HLS/m3u8)</span>
                    <button onclick="playDirectSource('https://vvf5.d21-anime77.com/7d2437233f05a9cf027ad847aa1d43ee9a776be088a06749d32370ca/episodedata/m3u8/t/tokyo-ghoul-episode-1-1648231517.m3u8', true)">Play</button>
                </div>

                <div class="source-item">
                    <span>Attack on Titan Episode 1 (HLS/m3u8)</span>
                    <button onclick="playDirectSource('https://lol.aheg-anime.com/90d72e1f7031cc5467854fec01755477fef3951ebb3a8fad02f7a36b/episodedata/m3u8/t/shingeki-no-kyojin-season-1-episode-1-1648239345.m3u8', true)">Play</button>
                </div>

                <div class="source-item">
                    <span>One Punch Man Episode 1 (MP4)</span>
                    <button onclick="playDirectSource('https://api-anime.watch/v3/streaming/one-punch-man/1/720p.mp4', false)">Play</button>
                </div>

                <div class="source-item">
                    <span>My Hero Academia Episode 1 (MP4)</span>
                    <button onclick="playDirectSource('https://api-anime.watch/v3/streaming/my-hero-academia/1/720p.mp4', false)">Play</button>
                </div>

                <div class="source-item">
                    <span>Custom HLS/m3u8 URL</span>
                    <div style="display: flex; gap: 10px; flex: 1; margin-left: 10px;">
                        <input type="text" id="customHlsUrl" placeholder="Enter HLS/m3u8 URL">
                        <button onclick="playCustomHls()">Play</button>
                    </div>
                </div>

                <div class="source-item">
                    <span>Custom MP4 URL</span>
                    <div style="display: flex; gap: 10px; flex: 1; margin-left: 10px;">
                        <input type="text" id="customMp4Url" placeholder="Enter MP4 URL">
                        <button onclick="playCustomMp4()">Play</button>
                    </div>
                </div>
            </div>

            <div class="status" id="status"></div>
        </div>

        <div class="examples">
            <h3>About Direct Player</h3>
            <p>This player uses direct video URLs instead of relying on an external API that might be down or unreachable. The hardcoded sources are examples and may stop working if the source sites change their URLs.</p>

            <p>For playing your own videos:</p>
            <ol>
                <li>Find a direct .mp4 URL or .m3u8 (HLS) stream URL</li>
                <li>Paste it into the custom URL input</li>
                <li>Click Play</li>
            </ol>

            <p><strong>Note:</strong> Many video hosts use CORS protection which may prevent playback. This player works best with URLs that allow cross-origin requests.</p>
        </div>
    </div>

    <script>
        // Load HLS.js for m3u8 support
        const hlsScript = document.createElement('script');
        hlsScript.src = 'https://cdn.jsdelivr.net/npm/hls.js@latest';
        document.head.appendChild(hlsScript);

        // Global variables
        let hls = null;

        // Function to show status messages
        function showStatus(message, isError = false) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = 'status';
            statusEl.classList.add(isError ? 'alert-error' : 'alert-success');
        }

        // Function to play a direct source
        function playDirectSource(url, isHls) {
            const videoPlayer = document.getElementById('videoPlayer');

            // Clean up previous HLS instance if any
            if (hls) {
                hls.destroy();
                hls = null;
            }

            try {
                console.log(`Playing ${isHls ? 'HLS' : 'MP4'} source: ${url}`);

                if (isHls) {
                    // Wait for HLS.js to load if necessary
                    if (typeof Hls === 'undefined') {
                        showStatus('Loading HLS.js library...', false);
                        hlsScript.onload = () => playHlsSource(url);
                    } else {
                        playHlsSource(url);
                    }
                } else {
                    // Direct MP4 URL
                    videoPlayer.src = url;
                    videoPlayer.load();
                    videoPlayer.play()
                        .then(() => showStatus('Video playing'))
                        .catch(err => {
                            console.error('Error playing video:', err);
                            showStatus(`Error playing video: ${err.message}`, true);
                        });
                }
            } catch (error) {
                console.error('Playback error:', error);
                showStatus(`Playback error: ${error.message}`, true);
            }
        }

        // Function to play an HLS source
        function playHlsSource(url) {
            const videoPlayer = document.getElementById('videoPlayer');

            if (Hls.isSupported()) {
                hls = new Hls({
                    debug: false,
                    enableWorker: true,
                    lowLatencyMode: true,
                    xhrSetup: function(xhr) {
                        xhr.withCredentials = false; // Disable passing cookies for cross-origin requests
                    }
                });

                hls.on(Hls.Events.ERROR, function(event, data) {
                    if (data.fatal) {
                        console.error('HLS fatal error:', data);
                        showStatus(`HLS error: ${data.details}`, true);

                        switch(data.type) {
                            case Hls.ErrorTypes.NETWORK_ERROR:
                                showStatus('Network error. This may be due to CORS restrictions.', true);
                                hls.destroy();
                                break;
                            case Hls.ErrorTypes.MEDIA_ERROR:
                                showStatus('Media error, attempting to recover', true);
                                hls.recoverMediaError();
                                break;
                            default:
                                showStatus(`Fatal error: ${data.details}`, true);
                                hls.destroy();
                                break;
                        }
                    }
                });

                hls.loadSource(url);
                hls.attachMedia(videoPlayer);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    videoPlayer.play()
                        .then(() => showStatus('HLS stream playing'))
                        .catch(err => {
                            console.error('Error playing HLS stream:', err);
                            showStatus(`Error playing HLS stream: ${err.message}`, true);
                        });
                });
            }
            else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                // Native HLS support (Safari)
                videoPlayer.src = url;
                videoPlayer.addEventListener('loadedmetadata', function() {
                    videoPlayer.play()
                        .then(() => showStatus('Native HLS stream playing'))
                        .catch(err => {
                            console.error('Error playing native HLS stream:', err);
                            showStatus(`Error playing native HLS stream: ${err.message}`, true);
                        });
                });
            } else {
                showStatus('HLS is not supported in this browser', true);
            }
        }

        // Function to play a custom HLS URL
        function playCustomHls() {
            const customUrl = document.getElementById('customHlsUrl').value.trim();
            if (!customUrl) {
                showStatus('Please enter an HLS/m3u8 URL', true);
                return;
            }

            // Add a proxy if the URL might have CORS issues
            let urlToPlay = customUrl;
            if (!customUrl.startsWith('https://cors-anywhere.herokuapp.com/') &&
                !customUrl.startsWith('https://api.allorigins.win/raw?url=')) {
                // Uncomment the line below if you want to automatically use a CORS proxy
                // urlToPlay = `https://api.allorigins.win/raw?url=${encodeURIComponent(customUrl)}`;
            }

            playDirectSource(urlToPlay, true);
        }

        // Function to play a custom MP4 URL
        function playCustomMp4() {
            const customUrl = document.getElementById('customMp4Url').value.trim();
            if (!customUrl) {
                showStatus('Please enter an MP4 URL', true);
                return;
            }

            // Add a proxy if the URL might have CORS issues
            let urlToPlay = customUrl;
            if (!customUrl.startsWith('https://cors-anywhere.herokuapp.com/') &&
                !customUrl.startsWith('https://api.allorigins.win/raw?url=')) {
                // Uncomment the line below if you want to automatically use a CORS proxy
                // urlToPlay = `https://api.allorigins.win/raw?url=${encodeURIComponent(customUrl)}`;
            }

            playDirectSource(urlToPlay, false);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showStatus('Player ready. Select a source to play.');
        });
    </script>
</body>
</html>
